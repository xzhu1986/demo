<#import "/reseller-portal/resellerFrame.html" as rframe> 
<#include '/common/frame/global-settings.html'>

<@rframe.reseller "jobs">
<div id="content">
	<div id="contentBody">
		<@shiro.hasPermission name="resellerportal:create_edit_job">
		<div id="actionBar">
			<ul>
				<li><a href="${basePath}/reseller-portal/jobs/create" target='_blank'>Create</a></li>
			</ul>
		</div>
		</@shiro.hasPermission>
		
		<div id="sidebar">
			<div class="surroundingBox">
				<h2>Filters</h2>
				<ul id='query-filters'>
					<#assign dataList=transforEnumToList('au.com.isell.rlm.module.jbe.vo.JobSearchFilter',"false")>
					
					<#list dataList as dataItem>
						<#if filter?? && filter?string==dataItem.key?string>
							<li class="selected"><a href="" data-val='${dataItem.key}' >${dataItem.name}</a></li>
						<#else>
							<li><a href="" data-val='${dataItem.key}' >${dataItem.name}</a></li>
						</#if>
					</#list>
				</ul>
			</div>
		</div>
		
		<div id="contentMain">
			<form action="#"  autocomplete="off" id='search-form'>
				<input type="hidden" name='filter' value='${filter!}'/>
				<table  class="maxWidthTable sortable">
					<tr id="filter">
						<th width='10%'><input name="jobNo"   type="text" style="width:100%" value='${jobNo!}'/></th>
						<th width='45%'><input name="jobName"   type="text" style="width:100%" value='${jobName!}'/></th>
						<th width='15%'>
							<select name='type' style="width:100%">
								<option value=""></option>
								<#assign dataList=dataLoader('au.com.isell.rlm.module.jbe.service.JobService',"getJobTypes")/> 
								<@htmlGen.selOptions type!'' dataList {"key":"typeId","display":"typeName"}/>
							</select>
						</th>
						<th width='10%'>
							<select name="status" style="width:100%">
								<option value=""></option>
								<#assign dataList=transforEnumToList('au.com.isell.rlm.module.jbe.domain.JobStatus',"true","true")>
								<@htmlGen.selOptions status!'' dataList {"key":"key","display":"name"}/>
							</select>	
						</th>
						<th width='10%'>
							<select name='stage' style="width:100%">
								<option value=""></option>
								<#assign dataList=dataLoader('au.com.isell.rlm.module.jbe.service.JobService',"getJobStages")> 
								<@htmlGen.selOptions stage!'' dataList {"key":"stageID","display":"stageName"}/>
							</select>
						</th>
						<th>
							<select name="priority">
								<option value=""></option>
								<#assign dataList=transforEnumToList('au.com.isell.rlm.module.jbe.domain.JobPriority',"true","true")>
								<@htmlGen.selOptions priority!'' dataList {"key":"key","display":"name"}/>
							</select>	
						<input id="search" type="submit" title="Search" value="" /> 
						<input id="cancel" value="" type="reset" /></th>
					</tr>
				
					<tr id="filterTitle">
						<td>Job No.</td>
						<td>Job Name</td>
						<td>Type</td>
						<td>Status</td>
						<td>Stage</td>
						<td>Priority</td>
					</tr>
					
					<#if data??>
						<#list data as item>
							<tr>
								<td><a href="${basePath}/reseller-portal/jobs/${item.jobId}/detail" target='_blank'>${item.jobId!}</a></td>
								<td>${item.jobName!}</td>
								<td>${item.typeName!}</td>
								<td>
									<#assign dataList=transforEnumToList('au.com.isell.rlm.module.jbe.domain.JobStatus',"true","true")>
									<#list dataList as dataItem>
										<#if item.statusID?? && item.statusID?string==dataItem.key?string>
											${dataItem.name}
										</#if>
									</#list>
								</td>
								<td>${item.stageName!}</td>
								<td>
									<#assign dataList=transforEnumToList('au.com.isell.rlm.module.jbe.domain.JobPriority',"true","true")>
									<#list dataList as dataItem>
										<#if item.jobPriority?? && item.jobPriority?string==dataItem.key?string>
											${dataItem.name}
										</#if>
									</#list>
								</td>
							</tr>
						</#list>
					</#if>
				</table>
					
				<div id="pageLinks">
					<@pagingBar.pagingBar1 paging/>
				</div>
			</form>
		</div>
		
		<div style="clear: both;"></div>
	</div>
</div>
<script type="text/javascript" src="${resourceBasePath}/js/entry/reseller-portal/jobs/jobs.js"></script>
</@rframe.reseller>
