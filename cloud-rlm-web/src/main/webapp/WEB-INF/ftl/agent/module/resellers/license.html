<#import "/agent/module/resellers/resellerFrame.html" as rframe>
<#assign transforEnumToList = "au.com.isell.rlm.common.freemarker.func.EnumToList"?new()>
<#import "/common/utils/html-generator.html" as htmlGen>
<#assign dataLoader = "au.com.isell.rlm.common.freemarker.func.DataLoader"?new()>

<@rframe.reseller>
		<div id="content">
				<@rframe.resellerNavTabs "license"/>
				
				<div id="contentBody">
					<form action="#" autocomplete="off" method="post" id="license-form">
						<div id="actionBar">
							<ul>
								<#if !(historyId??)>
									<@shiro.hasPermission name="reseller:edit">
										<li><button class="link-btn edit-btn" type="button">Edit</button></li>
										<li><button class="link-btn save-btn">Save</button></li>
										<li><button class="link-btn cancel-btn" type="reset">Cancel</button></li>
									</@shiro.hasPermission>
								</#if>
							</ul>
						</div>
						
						<div class="commonBox">
							<h2>ITQuoter</h2>
							<table>
								<tr>
									<td>Renewal Date</td>
									<td>
									<#if (itqLicense.renewalDate)??>
									<input type="date" title="Date Format yyyy-mm-dd" size="10" class="format-y-m-d date divider-dash" 
										value='${itqLicense.renewalDate?string("yyyy-MM-dd")}' name="itqLicense.renewalDate"/>
									<#else>
									<input type="date" title="Date Format yyyy-mm-dd" size="10" class="format-y-m-d date divider-dash" 
										name="itqLicense.renewalDate"/>
									</#if>
									<input type="button" id="clear-calendar" class="clear-calendar-btn" /></td>
								</tr>
								
								<tr>	
									<td>Annual Fee</td>
									<td><input type="text" size="10" value='${(itqLicense.annualFee)!}' name="itqLicense.annualFee" reg="^\d+(\.\d+){0,1}$" tip="numbers"/>
									${(billingInfo.currency)!} + ${(billingInfo.gst)!0}%
									</td>
								</tr>
									
								<tr>	
									<td>Full Access Users</td>
									<td>
										<input type="text" size='10' value='${(itqLicense.itqFullAccessUsers)!}' name="itqLicense.itqFullAccessUsers" reg="^\d*$" tip="numbers"/>
										</td>
								</tr>
									
								<tr>	
									<td>Service Users</td>
									<td><input type="text" size='10' value='${(itqLicense.itqServiceUsers)!}' name="itqLicense.itqServiceUsers" reg="^\d*$" tip="numbers"/></td>
								</tr>
									
								<tr>	
									<td>CRM Users</td>
									<td><input type="text" size='10' value='${(itqLicense.itqCrmUsers)!}' name="itqLicense.itqCrmUsers" reg="^\d*$" tip="numbers"/></td>
								</tr>
								
								<tr>	
									<td>Temp Users</td>
									<td><input type="text" size='10' value='${(itqLicense.itqTempUsers)!}' name="itqLicense.itqTempUsers" reg="^\d*$" tip="numbers"/></td>
								</tr>
								
								<tr>	
									<td>Temp Expiry</td>
									<td>
									<#if (itqLicense.itqTempExpiryDate)??>
									<input type="date" title="Date Format yyyy-mm-dd" size="10" class="format-y-m-d date divider-dash" 
										value='${itqLicense.itqTempExpiryDate?string("yyyy-MM-dd")}' name="itqLicense.itqTempExpiryDate" />
									<#else>
									<input type="date" title="Date Format yyyy-mm-dd" size="10" class="format-y-m-d date divider-dash" 
										name="itqLicense.itqTempExpiryDate"/>
									</#if>
									<input type="button" id="clear-calendar" class="clear-calendar-btn" /></td>
								</tr>
								
								<tr>	
									<td>Image Feeds</td>
									<td><input type="checkbox"  ${((itqLicense.itqImageFeeds)!false)?string( "checked='checked'","")} name="itqLicense.itqImageFeeds"/></td>
								</tr>
								
								<tr>	
									<td>Bid Importer</td>
									<td><input type="checkbox"  ${((itqLicense.bidImporter)!false)?string( "checked='checked'","")} name="itqLicense.bidImporter" /></td>
								</tr>
								
								<tr>	
									<td>API Support</td>
									<td><input type="checkbox"  ${((itqLicense.itqApiSupport)!false)?string( "checked='checked'","")} name="itqLicense.itqApiSupport" /></td>
								</tr>
								
								<tr>	
									<td>Silent Upgrades</td>
									<td><input type="checkbox"  ${((itqLicense.itqSilentUpgrades)!false)?string( "checked='checked'","")} name="itqLicense.itqSilentUpgrades" /></td>
								</tr>
								
								<tr>	
									<td>Service Manager</td>
									<td><input type="checkbox"  ${((itqLicense.itqServiceManger)!false)?string( "checked='checked'","")} name="itqLicense.itqServiceManger" /></td>
								</tr>
								
								<tr>	
									<td>Foreign Currency</td>
									<td><input type="checkbox"  ${((itqLicense.itqForeignCurrency)!false)?string( "checked='checked'","")} name="itqLicense.itqForeignCurrency" /></td>
								</tr>
								
								<tr>	
									<td>Warehouse Module</td>
									<td><input type="checkbox"  ${((itqLicense.itqWarehouseModule)!false)?string( "checked='checked'","")} name="itqLicense.itqWarehouseModule" /></td>
								</tr>
							</table>
						</div>
								
						<div class="commonBox">
							<h2>Ecommerce</h2>
							<table>
								<tr>
									<td>Renewal Date</td>
									<td>
									<#if (ecomLicense.renewalDate)??>
									<input type="date" title="Date Format yyyy-mm-dd" size="15" class="format-y-m-d date divider-dash" 
										value='${ecomLicense.renewalDate?string("yyyy-MM-dd")}' name="ecomLicense.renewalDate" />
									<#else>
									<input type="date" title="Date Format yyyy-mm-dd" size="15" class="format-y-m-d date divider-dash" 
											name="ecomLicense.renewalDate" />
									</#if>
									<input type="button" id="clear-calendar" class="clear-calendar-btn" /></td>
								</tr>
								
								<tr>	
									<td>Annual Fee</td>
									<td><input type="text" size="10" value='${(ecomLicense.annualFee)!}' name="ecomLicense.annualFee"  reg="^\d+(\.\d+){0,1}$" tip="numbers"/></td>
								</tr>
								
								<tr>	
									<td>Ecommerce</td>
									<td><select name="ecomLicense.ecomType">
											<#assign dataList=transforEnumToList('au.com.isell.rlm.module.reseller.domain.license.EComLicense$EComType',"false")> 
											<@htmlGen.selOptions (ecomLicense.ecomType)!'' dataList {"key":"key","display":"name"}/>
										</select></td>
								</tr>
								
								<tr>	
									<td>Multi Catalogues</td>
									<td><input type="checkbox"  ${((ecomLicense.ecomMultiCatalogues)!false)?string( "checked='checked'","")} name="ecomLicense.ecomMultiCatalogues" /></td>
								</tr>
								<tr>	
									<td>Export Catalogues</td>
									<td><input type="checkbox"  ${((ecomLicense.ecomExportCatalogues)!false)?string( "checked='checked'","")} name="ecomLicense.ecomExportCatalogues" /></td>
								</tr>
								
								<tr>	
									<td>Web Portals</td>
									<td>
										<select name="epdLicense.ecomWebPortals">
											<#assign webPortals=(ecomLicense.ecomWebPortals)!-1>
											<#list [1,2,3,4,5,6,7,8,9,10] as dataItem>
												<#if dataItem==webPortals>
													<option value="${dataItem}" selected="selected">${dataItem}</option>
												<#else>
													<option value="${dataItem}">${dataItem}</option>
												</#if>
											</#list>
										</select>
									</td>
								</tr>
							</table>
							<br />
							<br />
							<h2>EPD</h2>
							<table>
								<tr>
									<td>Renewal Date</td>
									<td>
									<#if (epdLicense.renewalDate)??>
									<input type="date" title="Date Format yyyy-mm-dd" size="10" class="format-y-m-d date divider-dash"
										value='${epdLicense.renewalDate?string("yyyy-MM-dd")}' name="epdLicense.renewalDate" />
									<#else>
									<input type="date" title="Date Format yyyy-mm-dd" size="10" class="format-y-m-d date divider-dash"
										name="epdLicense.renewalDate" />
									</#if>
									<input type="button" id="clear-calendar" class="clear-calendar-btn" /></td>
								</tr>
								
								<tr>	
									<td>Annual Fee</td>
									<td><input type="text" size="10"value='${(epdLicense.annualFee)!}' name="epdLicense.annualFee"  reg="^\d+(\.\d+){0,1}$" tip="numbers"/></td>
								</tr>
								
								<tr>	
									<td>ITQuoter</td>
									<td><select name="epdLicense.epdITQuoterUsage">
											<#assign dataList=transforEnumToList('au.com.isell.rlm.module.reseller.domain.license.EPDLicense$Level',"false")> 
											<@htmlGen.selOptions (epdLicense.epdITQuoterUsage)!'' dataList {"key":"key","display":"name"}/>
										</select></td>
								</tr>
								 
								<tr>	
									<td>Ecommerce</td>
									<td><select name="epdLicense.epdEcomUsage">
											<#assign dataList=transforEnumToList('au.com.isell.rlm.module.reseller.domain.license.EPDLicense$Level',"false")> 
											<@htmlGen.selOptions (epdLicense.epdEcomUsage)!'' dataList {"key":"key","display":"name"}/>
										</select></td>
								</tr>
								
								<tr>	
									<td>Agency</td>
									<td>
										<select disabled="disabled" name="epdLicense.epdAgencyID">
										 <#assign dataList=dataLoader('au.com.isell.rlm.module.agent.service.AgentService',"getAgencyList")> 
											<@htmlGen.selOptions (epdLicense.epdAgencyID)!'null' dataList {"key":"agentId","display":"name"}/>
										</select>
									</td>
								</tr>
							</table>
						</div>
						
						<div class="commonBox">
							<h2>License Review Date and Details</h2>
							<table>
								<tr>
									<td>Next Review</td>
									<td>
										<#if reseller.nextReviewDate??><#assign date=reseller.nextReviewDate?date/><#else><#assign date=''/></#if>
										<input type="text" size="10" value="${date}" name='reseller.nextReviewDate' id='nextReviewDate'/>
										<button type='button' class='link-btn' id='updateReview'>Update</button>
									</td>
								</tr>
								
								<tr>
									<td>Last Review</td>
									<td>
										<#if reseller.lastReviewDate??><#assign date=reseller.lastReviewDate?date/><#else><#assign date=''/></#if>
										<input type="text" size="20"  value="${date} - ${lastReivewUser!''}" id='lastReviewDateDisplay' />
										<input type="hidden" value="${reseller.lastReviewUser!}" name='reseller.lastReviewUser' id='lastReviewUser' />
										<input type="hidden" value="${date}" name='reseller.lastReviewDate' id='lastReviewDate' />
									</td>
								</tr>
								
								<tr>
									<td class="topAligned">Comment</td>
									<td><textarea  name='reseller.reviewComment' cols="30" rows="3">${reseller.reviewComment!}</textarea></td>
								</tr>
							</table>
							<br />
							<br />
							<h2>Usage</h2>
							<table>
								<tr>
									<td>Version</td>
									<td><input class="disabled unmodified" disabled="disabled" type="text" size="20" value="${(reseller.version)!}" /></td>
								</tr>
			
								<tr>	
									<td>Quoting Users</td>
									<td><input class="disabled unmodified" disabled="disabled" type="text" size="10" value="${(resellerUsage.quotingUsers)!}" /></td>
								</tr>
			
								<tr>
									<td>Orderering Users</td>
									<td><input class="disabled unmodified" disabled="disabled" type="text" size="10" value="${(resellerUsage.orderingUsers)!}" /></td>
								</tr>
			
								<tr>
									<td>Opportunity Users</td>
									<td><input class="disabled unmodified" disabled="disabled" type="text" size="10" value="${(resellerUsage.opportunityUsers)!}" /></td>
								</tr>
			
								<tr>
									<td>Job Users</td>
									<td><input class="disabled unmodified" disabled="disabled" type="text" size="10" value="${(resellerUsage.jobUsers)!}" /></td>
								</tr>
			
								<tr>
									<td>Free Users</td>
									<td><input class="disabled unmodified" disabled="disabled" type="text" size="10" value="${(resellerUsage.freeUsers)!}" /></td>
								</tr>
			
								<tr>
									<td>Total Users</td>
									<td><input class="disabled unmodified" disabled="disabled" type="text" size="10" value="${(resellerUsage.totalUsers)!}" /></td>
								</tr>
			
								<tr>
									<td>Quote Count</td>
									<td><input class="disabled unmodified" disabled="disabled" type="text" size="10" value="${(resellerUsage.quoteCount)!}" /></td>
								</tr>
			
								<tr>
									<td>Order Count</td>
									<td><input class="disabled unmodified" disabled="disabled" type="text" size="10" value="${(resellerUsage.orderCount)!}" /></td>
								</tr>
			
								<tr>
									<td>Job Count</td>
									<td><input class="disabled unmodified" disabled="disabled" type="text" size="10" value="${(resellerUsage.jobCount)!}" /></td>
								</tr>
			
								<tr>
									<td>Ecom Logins</td>
									<td><input class="disabled unmodified" disabled="disabled" type="text" size="10" value="${(resellerUsage.ecomLogins)!}" /></td>
								</tr>
							</table>
						</div>
						
						<div style="clear: both;"></div>
						</form>
					</div>
				</div>
		
		<script type="text/javascript" src="${rframe.resourceBasePath}/js/entry/agent/module/reseller/license.js"></script>
</@rframe.reseller>
