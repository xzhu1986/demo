<#import "emailTplFrame.html" as sframe>
<#include '/common/frame/global-settings.html'>

<@sframe.setting>
<div id="content">
	<style type="text/css">
		.file:hover { cursor: pointer; !important}
	</style>

	<@sframe.settingNavTabs "details"/>

	<div id="contentBody">
		<form action="#" autocomplete="off" method="post" id="detail-form">
			<input type="hidden" name='allAttaches' id='allAttaches'/>
			<div id="actionBar">
				<ul>
					<@shiro.hasPermission name="setting:edit">
					<li><button class="link-btn edit-btn" type="button">Edit</button></li>
					<li><button class="link-btn save-btn">Save</button></li>
					<li><button class="link-btn cancel-btn" type="reset">Cancel</button></li>
					</@shiro.hasPermission>
				</ul>
			</div>
			<div class="commonBox autoWithCommonBox">
				<h2>Email Template Details</h2>
				<table>
					<tr class="currency-item">
						<td>Name</td>
						<td><input type="text" class="maxWidthInput" value="${data.typeName!}" name="typeName" reg='^.+$'/></td>
					</tr>
					<tr>
						<td>Subject</td>
						<td><input type="text" class="maxWidthInput" value="${data.subject!}" name="subject" reg='^.+$'/></td>
					</tr>
					<tr>
						<td>Parameter Target</td>
						<td>
							<select name="target" reg='^.+$' id="paramTarget">
								<option value=""></option>
								<#assign dataList=transforEnumToList('au.com.isell.rlm.module.mail.domain.EmailTargetType',"false")> 
								<@htmlGen.selOptions (data.target)!'null' dataList {"key":"key","display":"name"}/>
							</select>
						</td>
					</tr>
					<tr>
						<td>Sender</td>
						<td><input type="text" class="maxWidthInput" value="${data.defaultSender!}" name="defaultSender" reg='(.+@.+\..+)?'/></td>
					</tr>
					<tr>
						<td class="topAligned" reg='^.+$'>Body</td>
						<td>
							<div id='mailBodyContainer'>
								<textarea rows="25" cols="60" name="body" id="mailBody">${data.body!}</textarea></td>
							</div>
					</tr>
					<tr>
						<td>Attachment</td>
						<td>
							<input class="link-btn" type="button" value="New Attachment" id="addAttachment" data-url='${basePath}/upload?callbackUrl=/upload/info.json'/>
						</td>
					</tr>
					<tr>
						<td>
						</td>
						<td>
							<ul id='uploaded-attachments'>
								<#if data.attachments??>
									<#list data.attachments as key>
										<li class="attachment-row">
											<a href="${basePath}/file?key=${key}" target="_blank" data-key='${key}' class="linkWithUnderline attach-link">${key}</a>
											<input type="button" class="link-btn delete-btn red" alt="delete this attachment" data-url="${basePath}/file/delete.json?key=${key}" value="X">
										</li>
									</#list>
								</#if>
							</ul>
					</tr>
				</table>
			</div>
			
			<div class="commonBox autoWithCommonBox">
			<br><br>
				<ul id='targetParamsDef'>
					<#if targetParams??>
						<#list targetParams as item>
							<li>&#36;{${item}}</li>
						</#list>
					</#if>
				</ul>
			</div>

			<div style="clear: both;"></div>
		</form>
	</div>
</div>
<script type="text/javascript" src="${sframe.resourceBasePath}/js/entry/agent/module/setting/email-tpl-detail.js"></script>
</@sframe.setting>
